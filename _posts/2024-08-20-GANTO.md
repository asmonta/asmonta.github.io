---
title: Generative Adversarial Network for Topology Optimization
categories: [AI/ML]
tags: [3D Printing, Programming, MATLAB, Python, AI/ML]
render_with_liquid: false
---

While working on the infill patterns for my [slicer <span class="fa-solid fa-link"/>](https://asmonta.github.io/posts/Slicer/), I had the idea to topology optimize the cross-sections of the part. TO cross sections should produce stiffer parts compared to parts constructed with arbitrary infill patterns, but incur a hefty computational cost. GANs offer a unique solution to drastically reduce the computational cost.

# Overview

I was interested in making parts more resilient to impact. Assuming each region of the part has an equal chance of hitting the ground, which imparts a force normal to the surface, the contact force distributed across the shape’s perimeter creates a hydrostatic pressure field. This pressure field will be used as the boundary condition in topology optimization.

<img src="pictures/GANTO/FBD.png" alt="FBD" width="200"/>


## Dataset Generation
The dataset used to train the network was created in four steps. First, a circle or rectangle was selected as the base shape, with 48 evenly spaced nodes placed on its perimeter. These nodes were then randomly translated, and the weak convex hull of these points was used to construct the topology for subsequent optimization, an example of which is below:

<img src="pictures/GANTO/1878_nat.jpg" alt="Randomized Generated Shape" width="200"/>

Using the previously generated topology, a dense point cloud is created within its area. Lloyd’s
algorithm is then applied to generate elements of equal area, forming the shape’s mesh. The
hydrostatic condition is applied. From these conditions, the topology is optimized resulting in the design below:

<img src="pictures/GANTO/1878_top.jpg" alt="Optimized Topology" width="200"/>


## Tensorflow
TensorFlow was used to train the neural network. The input to the network was the unoptimized topology, while the output was the optimized topology. Training lasted for 48 hours on a cluster computer. In the image to the right, the top row shows the original shapes, the middle row displays the network’s optimized topologies, and the bottom row presents the optimized topology.

<img src="pictures/GANTO/Tops_s3000_wL_plot_630000.png" alt="Tensorflow Comparison" width="200"/>

## Implementation
Using the GAN network, slices are fed into the system to produce an approximated optimized topology. Since the resulting topologies are often difficult to manufacture, a filter is applied to the output. This filter removes small cavities and smooths the rest, resulting in the final optimized topology

<img src="pictures/GANTO/1_nat.jpg" alt="Natural Shape" width="200"/>

<center>Initial Shape</center>

<img src="pictures/GANTO/1_top.jpg" alt="NN Output" width="200"/>

<center>NN Output</center>

<img src="pictures/GANTO/topGanSmooth.png" alt="Smoothed" width="200"/>

<center>Processed Output</center>